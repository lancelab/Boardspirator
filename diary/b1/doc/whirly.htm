<!DOCTYPE html>
<html>
	<head>
  
		<meta name="copyright" content="2011-2012 (c) Konstantin Kirillov">
		<meta name="description" content="Board Puzzle Framework, Whirly"> 
		<meta name="keywords" content="whirly, board game, puzzle game, on line game, game development, educational game, sokoban"> 

		<title>Whirly. Draft.</title>

		<link rel="stylesheet" href="css/whirly.css">

		<script type="text/javascript" >window.tp$ = window.tp$ || {}; window.tp$.reset_path_from_land_to_app_root = '..' ;</script>
		<script type="text/javascript" src="../prod/app.js""></script>
		<script type="text/javascript" src="js/macrify.js"></script>




	</head>
		<body>
			<div style="color:#666666; white-space:pre; font-family:monospace; ">

				This page won't display if no JavaScript language enabled in your browser.
				To display this page, turn JavaScript on.

			</div>

			<div style="white-space:pre; font-family:monospace; visibility:hidden;">
				<span style="visibility:hidden;">This token, #@title@#   , is a necessary flag to unhide this page.</span>
				<pre>

	<h1>Draft</h1>

	<h1><a href="../">Whirly ..</a></h1>
				.. is a generalization of Sokoban game,
				.. is a root for derivation any #@WebSiteWithTitle@# game,
				.. where game is defined by rules, map, and objective:


	<b>Map</b> ..

		.. is a set of units which are cubes in 3D space. 

		Maps have a flat index: location of each unit is defined by x,y planar
		coordinates of the unit. Units can stack on each other, like wall on ground,
		target on ground, box on target, or hero on wall, ...

		Units have attributes: breed, activity, and motive.
		For example, in Sokoban, breeds are boxes, walls, grounds, ...

		Activity attribute can be active, passive, or static.
		Active unit is an unit which can moved by user's action. For example, hero in Sokoban.
		Passive unit is an unit which can be moved as a result of interaction. Like box in Sokoban.
		Active and passive units called dynamic.
		There can be only one dynamic unit in map's cell unit stack and it can be only on top of the stack.

		Motive can be a baton or goal. Motives used to define objective, like delivering baton-boxes to goals in Sokoban.




	<b>Breeds</b>

		Breeds have additinal attribute - color. In other words breed is a couple (race, color).
		Races are heros, walls, boxes, targets, grounds.
		
		<a href="../core/def/games/base_game.js">Implemented races are</a>:
			
			hero,
			box,
			target,
			htarget,
			wall,
			ground
			
		Colors are: 0, 1, 2, 3, ...  denoted as x, a, b, c, d, ... 

		0 - "colorless" color, 1 - blue, 2 - green, 3 - red, ...
		"Colorless color" often called black, grey, or white.

		For example, hero_x is colorless hero, box_a - blue box, ...

		There is only one race of active units, hero.



	<a id="interactions"> </a>
	<b>Rules .. </b>

		.. is an interaction matrix - matrix of available interactions between breeds:
		
			push  - acting unit can push neighbour unit, actee, like in Sokoban,
			pull  - acting unit pulls neighbour,
			swap  - acting unit swaps with neighbour,
			leap  - neigbour leaps over actor,
			jump  - actor jumps over units,
			...

		Rules have attributes: deepness and flockness.


	<b>Deepness</b> ..

			.. is a parameter of interaction, DEEPNESS_LIMIT. 
			It defines how far the inital hero's action can propagate through its neighbours.
			For examle, pushed box, can push second box if second box is on its way. If second box cannot push any other box, this means
			that deepness is 2. If 3 boxes can be pushed at once, deepness is 3. #@Sokoban@# is a game with deepness 1.

	<b>Flockness</b> ..

			.. is a parameter of interaction, herd_sense, which is a natural number n &gt; = 0
			( 0 stands for no-herd-effect ).
			Flocked interaction involves neighbours. This means if neighbour touched moved unit before move began,
			then this neighbour will do the same move if no obstacles prevent this.


	<a id="deriving"> </a>
	<b>Objective</b> ..

		.. of the game is to "fill" goals with color-matching-batons:
		Precisely: if number of targets less than number of batons, then deliver color-matching batons to all targets.
		Otherwise: deliver all batons to color-matching targets.


	<a id="deriving_fails"> </a>
	<h2>Deriving from  Whirly</h2>

	E x a m p l e s

		<a href="../def/albums/standalone/collections/default/simplest.txt">Simplest cfile</a>  - "Experimental Game" and <a href="../?asingle&curl=//def/albums/standalone/collections/default/simplest.txt">its play</a>.

			Of course, perhaps this game is boring. It omits some properties which you may like to assign
			to your own games. The original Sokoban credits are "leaked" through, because we did not assign
			our own. There is even no dress assigned from available core dresses, and description of
			new rules is not reworded.
			But this game is a "fist-class citizen" with other #@title@# games:
			it can be replayed, has solver, other maps can be landed on in context of this game.

			These short cfiles are good when one wants to quickly test a new set of rules.

		<a href="../def/albums/standalone/collections/default/sokoleap_demo.txt">Simple cfile</a> and <a href="../?asingle&curl=//def/albums/standalone/collections/default/sokoleap_demo.txt">its play</a>.

			This is the same "game" as above.
			This cfile has games, albums, and collection sections.
			In "albums" section, there is a description for new rules and objective. 
			Credits added to collection and collection is pointed to defined album.

		<a href="../def/albums/standalone/collections/default/leappush_demo.txt">Simple cfile with game and subgame</a> and <a href="../?asingle&curl=//def/albums/standalone/collections/default/leappush_demo.txt">its play</a>.

			There are two games in cfile. The first game is still the same as above.
			The second game is derived from the first with added twist:
				the frog leaps and pushes another frog if latter is on its way.
			The second game is dressed by using one of core dresses.
			There are also variations of dress for specific maps.			

		<a href="../def/albums/standalone/collections/default/power_jumppush_demo.txt">Power JumpPush</a> and <a href="../?asingle&curl=//def/albums/standalone/collections/default/power_jumppush_demo.txt">its play</a>.

			In this game, heros have a little more power, they can interact at most with two boxes.
			The "green" hero is special in this game, it can jump over blue boxes.
			This all is clearly set in cfile text.
			But, consequences are dramatic, this game is completely different than Colorban.

		<a href="whirly_and_sokoban.htm#more_games">GhostJump</a>.  Cfile contains album which refers to collection.

			Has more elaborated dress. "Jump" rule creates effect of going through units.

		<a href="whirly_and_sokoban.htm#sandbox">Sandbox.</a>



	Example, core games: <a href="../def/games.json.txt">definition seeds</a> bundled with #@title@#.

	These game-properties may justify derivation (subclassing) a game:

		credits. 
			Some Whirly parameters subclass to a game which is already invented and has a name.
			Example: Sokoban.

		dresses.
			Example. Rules of Subgame can be the same as of parent, but expected class of maps
					can be narrower and expect special dresses like Sokoban game expect monochrome maps.

		Solver simplilfications. - going to be implemented.
			Narrowed maps may allow simplifications of solver. (Like detecting dead locks in Sokoban maps.)

		interact and unconditional-behavior
			This is rules. Certainly, game must be subclassed if rules changed.

		Repeatedly, rules is not a final judge to consider a separate game definition.

	This should be a topic of itself ...
	Deriving dresses: <a href="../core/def/proc/derive.js">//.\\	collects 4 dresses from </a>

	Unconditional-behavior is game.cols[cname].pass property. Its range is true or false.
		For example, it is true for targets by default.
	game.interact is interaction matrix. The range is <a href="#interactions">these interactions.</a>



	<a id="restrictions"> </a>
	R e s t r i c t i o n s    f o r    C u s t o m - D e r i v e d   G a m e s</a>

		1. Parent and child games must have:

			herd_sense = 0 
			DEEPNESS_LIMIT = 1

			Subclassing to arbitrary DEEPNESS_LIMIT is safe only when interactions 

				( hero_..., box_... ) are push, leap, jump, and
				( box_...,  box_... ) are push.

		2. Setting interaction matrix for new game must allow play-sessions which
		   create postions violating condition
		   "one_dynamic_unit_on_top : true" described here: <a href="../core/def/games/base_game.js">//\\ APPLICATION ASSUMPTIONS</a>

		However, core games or games in readme-examples must work unrestrictedly.

		In particular, this unfortunately means you cannot derive from Flocks or from Colortrain.

		These restriction cased by incomplete implementation of Whirly concept.
		More software development is required to implement concept in full.




	<b>Color-Match-Games</b>

		.. are such games where rules do not depend on pair of colors,
		but depend on outcome of their colors match and races.
		If one of units is colorless or units have the same color, then units are "color-matching".
		Otherwise, they are not color-matching. (This is a match based on "wearing"
		filter-glasses with own color.)
		Not all Whirly games are "Color-Match-Games". 
		This term is only for classification. There is no "Color-Match" property to control application
		behavior.





	<a id="dualgames"> </a>
	<h2>Features</h2>

	D u a l   G a m e s

	Two games G, H called co-games if they have equal set of legal positions and
			
		1. for each move a - b in G, there exists move b - a in H and vice versa,
		2. there is one-to-one correspondence g |-&gt; h between actions g, h such
		   h results in co-move of g.

	Examples: 
		#@Sokoban@# and coSokoban. #@PullPush@# and #@Co-PullPush@#: <!-- #@Pull-Swap-Push@# and #@Co-Pull-Swap-Push@#. -->
			pull and push, left-move and right-move are co-actions.
			Path uullURdl and ruRUrrdd are copaths.

	Copath of solution is a solution of cogame. Finding longest departure from given position in co-game
	helps to construct a map leading to given position in direct game.
	
	#@Doubleban@#, #@Colortrain@#, and #@Monkeyban@# have no implemented co-games.



	M i x i n g    m a p s

	Whirly can convert maps of one game to play them in other game for two cases:
		#@Sokoban@# --&gt; #@PullPush@#: <a href="../?akey=pullpush&collection_ix=1">Modified map</a> and
		#@Sokoban@# --&gt; #@Monkeyban@#: <a href="../?akey=monkeyban&collection_ix=1">Modified map</a>
		In such transformation, unit's breed may be changed; however, such transformations do not necessarily result in 
		interesting games.

	(See settings of collection property sugar.do_colorize_randomly.)





	<a id="extending"> </a>
	<h2>Extending Whirly</h2>

	.. means adding new type of interactions to interaction matrix.
	This requires reprogramming of scode.
	In simple cases like "push", "pull", "jump", ...,  this job is done in sections
	<a href="../core/interaction.js">///\\\ push,  ///\\\ pull,   ///\\\ jump, ...</a>
	


	Circular Links:

	<a  href="guest_readme.htm">Guest Readme</a>
	<a  href="whirly_and_sokoban.htm">Whirly and Sokoban Variants</a>
	<a  href="project_files.htm">Project Files</a>



#@WebSiteWithTitle@#:

Version:	#@version@#
Date:		#@date@#
Copyright:	#@copyright@#
EMail:		#@email@#



</pre></div>

	<script	type="text/javascript">
		jQuery.fn.tp$.gio.config.google_apps.insert_ad_div_with_script();
	</script>



</body></html>


